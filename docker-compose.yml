services:
  openclaw:
    image: openclawwechatmp:latest
    container_name: openclaw
    env_file:
      - .env
    ports:
      - "127.0.0.1:8787:8787"
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: unless-stopped
    security_opt:
      - no-new-privileges:true
    read_only: true
    tmpfs:
      - /tmp

  cloudflared:
    image: cloudflare/cloudflared:latest
    container_name: cloudflared
    command: tunnel run openclaw-wechat-mp
    depends_on:
      - openclaw
    volumes:
      - ./cloudflared/config.yml:/etc/cloudflared/config.yml:ro
      - ./cloudflared/credentials.json:/etc/cloudflared/credentials.json:ro
    restart: unless-stopped
    security_opt:
      - no-new-privileges:true
    read_only: true
    tmpfs:
      - /tmp